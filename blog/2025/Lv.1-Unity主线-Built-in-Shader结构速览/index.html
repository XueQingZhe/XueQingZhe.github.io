<!DOCTYPE html> <html lang="zh-CN"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Lv.1 Unity主线：Built-in Shader结构速览 | 吟处雪 轻遮 </title> <meta name="author" content="吟处雪 轻遮"> <meta name="description" content="Built-in Shader结构速览"> <meta name="keywords" content="technical-artist, shader, rendering, unity, unreal-engine, pbr, toon-shading"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xueqingzhe.github.io/blog/2025/Lv.1-Unity%E4%B8%BB%E7%BA%BF-Built-in-Shader%E7%BB%93%E6%9E%84%E9%80%9F%E8%A7%88/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">吟处雪</span> 轻遮 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">books </a> </li> <li class="nav-item "> <a class="nav-link" href="/tutorials/">tutorials </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Lv.1 Unity主线：Built-in Shader结构速览</h1> <p class="post-meta"> Created on December 21, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/shader"> <i class="fa-solid fa-hashtag fa-sm"></i> shader,</a>   <a href="/blog/tag/rendering"> <i class="fa-solid fa-hashtag fa-sm"></i> rendering,</a>   <a href="/blog/tag/unity"> <i class="fa-solid fa-hashtag fa-sm"></i> unity</a>   ·   <a href="/blog/category/tamonth01"> <i class="fa-solid fa-tag fa-sm"></i> TAMonth01</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh"># 基本结构</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203164844.png)
<span class="gh"># SubShader Tags</span>
<span class="gu">## Render Type</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203170938.png)
<span class="gu">## Queue</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203171204.png)
<span class="gu">## LOD</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">SubShader</span>
<span class="p">{</span>
    <span class="n">LOD</span> <span class="mi">300</span>  <span class="c1">// ← 这就是LOD关键字</span>
    <span class="n">Pass</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
<span class="p">```</span>

<span class="p">```</span><span class="nl">c
</span><span class="c1">// C#代码中设置 Shader.globalMaximumLOD = 200;</span>
<span class="c1">// 只使用LOD&lt;=200的SubShader </span>
<span class="p">```</span>
 
<span class="gs">**选择规则：**</span> 
如果设置 Shader.globalMaximumLOD = 200 
SubShader LOD 300 ← 跳过（超过限制）
SubShader LOD 200 ← ✅ 使用这个 
SubShader LOD 100 ← 不会用到（因为已经找到合适的） 

Unity内置Shader的LOD标准
<span class="gu">### Unity官方推荐的LOD值</span>

| LOD值 | 质量等级 | 示例Shader                        |
| ---- | ---- | ------------------------------- |
| 600+ | 最高质量 | 物理基础渲染 + 曲面细分                   |
| 500  | 非常高  | VertexLit + 所有像素光               |
| 300  | 高    | Diffuse + Specular + Normal Map |
| 200  | 中    | Diffuse + Specular              |
| 150  | 中低   | Diffuse + 简化光照                  |
| 100  | 低    | Vertex Lit（顶点光照）                |
| 50   | 最低   | 无光照                             |
<span class="gs">**Unity内置Shader的LOD值：**</span>
<span class="p">```</span><span class="nl">
</span>Standard Shader          = 300
Bumped Specular          = 300
Bumped Diffuse           = 200
Diffuse                  = 200
Specular                 = 200
VertexLit                = 100
Unlit                    = 100
<span class="p">```</span>
<span class="gu">## IgnoreProjector</span>
<span class="gs">**忽略投影**</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">Tags</span> <span class="p">{</span> <span class="s">"IgnoreProjector"</span><span class="o">=</span><span class="s">"True"</span> <span class="p">}</span>
<span class="p">```</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203171336.png)
<span class="gu">## ForceNoShadowCasting</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">Tags</span> <span class="p">{</span> <span class="s">"ForceNoShadowCasting"</span><span class="o">=</span><span class="s">"True"</span> <span class="p">}</span>
<span class="p">```</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203171503.png)
<span class="gu">## DisableBatching</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">Tags</span> <span class="p">{</span> <span class="s">"DisableBatching"</span><span class="o">=</span><span class="s">"True"</span> <span class="p">}</span>
<span class="p">```</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203171712.png)
<span class="gu">## PreviewType</span>
<span class="ges">***细节面板预览形状***</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">Tags</span> <span class="p">{</span> <span class="s">"PreviewType"</span><span class="o">=</span><span class="s">"Plane"</span> <span class="p">}</span>
<span class="p">```</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203172058.png)

<span class="gu">## CanUseSpriteAtlas</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">Tags</span> <span class="p">{</span> <span class="s">"CanUseSpriteAtlas"</span><span class="o">=</span><span class="s">"True"</span> <span class="p">}</span>
<span class="p">```</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203172147.png)
<span class="gh"># Pass Tags</span>
<span class="gu">## LightMode</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203172447.png)
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203172705.png)
<span class="gu">## RequireOptions</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203172836.png)
<span class="gu">## PassFlags</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203173126.png)
<span class="gh"># Pass keyworld</span>
<span class="gu">## Cull</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203173822.png)
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203174026.png)

<span class="gu">## ZTest</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203173840.png)
<span class="p">```</span><span class="nl">c
</span><span class="c1">// 普通物体（默认）</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZTest</span> <span class="n">LEqual</span>  <span class="c1">// 近的覆盖远的</span>
<span class="p">}</span>

<span class="c1">// 透视效果（X光）</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZTest</span> <span class="n">Greater</span>  <span class="c1">// 只显示被遮挡的部分</span>
    
    <span class="n">CGPROGRAM</span>
    <span class="n">fixed4</span> <span class="n">frag</span><span class="p">()</span> <span class="o">:</span> <span class="n">SV_Target</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">fixed4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>  <span class="c1">// 半透明红色</span>
    <span class="p">}</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>

<span class="c1">// UI/屏幕空间效果</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZTest</span> <span class="n">Always</span>  <span class="c1">// 忽略深度，总是显示</span>
<span class="p">}</span>

<span class="c1">// 描边效果（两个Pass）</span>
<span class="c1">// Pass 1: 正常渲染</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZTest</span> <span class="n">LEqual</span>
    <span class="n">CGPROGRAM</span>
    <span class="c1">// 正常渲染</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>

<span class="c1">// Pass 2: 描边</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZTest</span> <span class="n">Greater</span>  <span class="c1">// 只渲染被遮挡的部分作为描边</span>
    <span class="n">CGPROGRAM</span>
    <span class="c1">// 放大模型，渲染边缘</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>
<span class="p">```</span>
<span class="gu">## ZWrite</span>
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203173855.png)
<span class="p">![</span><span class="nv">图片</span><span class="p">](</span><span class="sx">/assets/img/TAMonth01/Pasted</span> image 20251203173944.png)<span class="sb">


</span><span class="gu">## Blend 混合模式</span>
<span class="p">```</span><span class="nl">c
</span><span class="c1">// 基础语法</span>
<span class="n">Blend</span> <span class="n">SrcFactor</span> <span class="n">DstFactor</span>
<span class="n">Blend</span> <span class="n">SrcFactor</span> <span class="n">DstFactor</span><span class="p">,</span> <span class="n">SrcFactorA</span> <span class="n">DstFactorA</span>  <span class="c1">// 分别控制RGB和Alpha</span>

<span class="c1">// 高级语法</span>
<span class="n">BlendOp</span> <span class="n">Add</span><span class="o">/</span><span class="n">Sub</span><span class="o">/</span><span class="n">RevSub</span><span class="o">/</span><span class="n">Min</span><span class="o">/</span><span class="n">Max</span>  <span class="c1">// 混合操作</span>
<span class="p">```</span>

<span class="gs">**混合因子：**</span>

| 因子 | 含义 |
|------|------|
| <span class="sb">`One`</span> | 1 |
| <span class="sb">`Zero`</span> | 0 |
| <span class="sb">`SrcColor`</span> | 源颜色 |
| <span class="sb">`SrcAlpha`</span> | 源Alpha |
| <span class="sb">`DstColor`</span> | 目标颜色 |
| <span class="sb">`DstAlpha`</span> | 目标Alpha |
| <span class="sb">`OneMinusSrcColor`</span> | 1 - 源颜色 |
| <span class="sb">`OneMinusSrcAlpha`</span> | 1 - 源Alpha |
| <span class="sb">`OneMinusDstColor`</span> | 1 - 目标颜色 |
| <span class="sb">`OneMinusDstAlpha`</span> | 1 - 目标Alpha |

<span class="gs">**混合公式：**</span>
<span class="p">```</span><span class="nl">c
</span><span class="err">最终颜色</span> <span class="o">=</span> <span class="p">(</span><span class="err">源颜色</span> <span class="o">*</span> <span class="n">SrcFactor</span><span class="p">)</span> <span class="n">BlendOp</span> <span class="p">(</span><span class="err">目标颜色</span> <span class="o">*</span> <span class="n">DstFactor</span><span class="p">)</span>
<span class="p">```</span>
<span class="gs">**常用混合模式**</span>
<span class="p">```</span><span class="nl">c
</span><span class="c1">// 1. 标准Alpha混合（透明）⭐⭐⭐⭐⭐</span>
<span class="n">Blend</span> <span class="n">SrcAlpha</span> <span class="n">OneMinusSrcAlpha</span>
<span class="c1">// 最终 = 源颜色 * 源Alpha + 目标颜色 * (1 - 源Alpha)</span>

<span class="c1">// 2. 加法混合（发光、粒子）⭐⭐⭐⭐⭐</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">One</span>
<span class="c1">// 最终 = 源颜色 + 目标颜色</span>

<span class="n">Blend</span> <span class="n">SrcAlpha</span> <span class="n">One</span>  <span class="c1">// 柔和的加法</span>
<span class="c1">// 最终 = 源颜色 * 源Alpha + 目标颜色</span>

<span class="c1">// 3. 乘法混合（阴影、滤镜）⭐⭐⭐</span>
<span class="n">Blend</span> <span class="n">DstColor</span> <span class="n">Zero</span>
<span class="c1">// 最终 = 目标颜色 * 源颜色</span>

<span class="n">Blend</span> <span class="n">Zero</span> <span class="n">SrcColor</span>  <span class="c1">// 等价写法</span>
<span class="c1">// 最终 = 源颜色 * 目标颜色</span>

<span class="c1">// 4. 正片叠底（Photoshop的Multiply）</span>
<span class="n">Blend</span> <span class="n">DstColor</span> <span class="n">SrcColor</span>
<span class="c1">// 最终 = 源颜色 * 目标颜色 + 目标颜色 * 源颜色</span>

<span class="c1">// 5. 减法混合⭐⭐</span>
<span class="n">BlendOp</span> <span class="n">Sub</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">One</span>
<span class="c1">// 最终 = 源颜色 - 目标颜色</span>

<span class="n">BlendOp</span> <span class="n">RevSub</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">One</span>
<span class="c1">// 最终 = 目标颜色 - 源颜色</span>

<span class="c1">// 6. 最小值/最大值</span>
<span class="n">BlendOp</span> <span class="n">Min</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">One</span>
<span class="c1">// 最终 = min(源颜色, 目标颜色)</span>

<span class="n">BlendOp</span> <span class="n">Max</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">One</span>
<span class="c1">// 最终 = max(源颜色, 目标颜色)</span>

<span class="c1">// 7. 预乘Alpha</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">OneMinusSrcAlpha</span>
<span class="c1">// 用于已经预乘了Alpha的纹理</span>

<span class="c1">// 8. 柔光（Soft Additive）</span>
<span class="n">Blend</span> <span class="n">OneMinusDstColor</span> <span class="n">One</span>
<span class="c1">// 亮处更亮，暗处影响小</span>

<span class="c1">// 9. 线性减淡（Screen）</span>
<span class="n">Blend</span> <span class="n">OneMinusDstColor</span> <span class="n">One</span>
<span class="n">Blend</span> <span class="n">One</span> <span class="n">OneMinusSrcColor</span>
<span class="p">```</span>
<span class="gs">**实际应用示例：**</span>
<span class="p">```</span><span class="nl">c
</span><span class="c1">// 火焰粒子（加法混合）</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZWrite</span> <span class="n">Off</span>
    <span class="n">Blend</span> <span class="n">SrcAlpha</span> <span class="n">One</span>  <span class="c1">// 柔和加法</span>
    
    <span class="n">CGPROGRAM</span>
    <span class="n">fixed4</span> <span class="n">frag</span><span class="p">()</span> <span class="o">:</span> <span class="n">SV_Target</span>
    <span class="p">{</span>
        <span class="n">fixed4</span> <span class="n">col</span> <span class="o">=</span> <span class="n">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
        <span class="n">col</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*=</span> <span class="n">_TintColor</span><span class="p">.</span><span class="n">rgb</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>  <span class="c1">// 增强亮度</span>
        <span class="k">return</span> <span class="n">col</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>

<span class="c1">// 玻璃（标准透明）</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZWrite</span> <span class="n">Off</span>
    <span class="n">Blend</span> <span class="n">SrcAlpha</span> <span class="n">OneMinusSrcAlpha</span>
    
    <span class="n">CGPROGRAM</span>
    <span class="n">fixed4</span> <span class="n">frag</span><span class="p">()</span> <span class="o">:</span> <span class="n">SV_Target</span>
    <span class="p">{</span>
        <span class="n">fixed4</span> <span class="n">col</span> <span class="o">=</span> <span class="n">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
        <span class="n">col</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">;</span>  <span class="c1">// 30%透明度</span>
        <span class="k">return</span> <span class="n">col</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>

<span class="c1">// 阴影投射（乘法混合）</span>
<span class="n">Pass</span>
<span class="p">{</span>
    <span class="n">ZWrite</span> <span class="n">Off</span>
    <span class="n">Blend</span> <span class="n">DstColor</span> <span class="n">Zero</span>  <span class="c1">// 正片叠底</span>
    
    <span class="n">CGPROGRAM</span>
    <span class="n">fixed4</span> <span class="n">frag</span><span class="p">()</span> <span class="o">:</span> <span class="n">SV_Target</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">fixed4</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">// 50%变暗</span>
    <span class="p">}</span>
    <span class="n">ENDCG</span>
<span class="p">}</span>
<span class="p">```</span>

<span class="gu">## ColorMask(颜色遮罩)</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">ColorMask</span> <span class="n">RGB</span>   <span class="c1">// 写入RGB（默认）</span>
<span class="n">ColorMask</span> <span class="n">A</span>     <span class="c1">// 只写入Alpha</span>
<span class="n">ColorMask</span> <span class="mi">0</span>     <span class="c1">// 不写入任何颜色</span>
<span class="n">ColorMask</span> <span class="n">RGBA</span>  <span class="c1">// 写入所有通道</span>

<span class="c1">// 组合使用</span>
<span class="n">ColorMask</span> <span class="n">R</span>     <span class="c1">// 只写红色</span>
<span class="n">ColorMask</span> <span class="n">RG</span>    <span class="c1">// 写红色和绿色</span>
<span class="n">ColorMask</span> <span class="n">BA</span>    <span class="c1">// 写蓝色和Alpha</span>
<span class="p">```</span>
<span class="gs">**应用场景：**</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">// 只写深度，不写颜色（透明物体预处理）
Pass
{
    ZWrite On
    ColorMask 0  // 不写任何颜色
}

// 只写Alpha通道
Pass
{
    ColorMask A
    CGPROGRAM
    fixed4 frag() : SV_Target
    {
        return fixed4(0, 0, 0, _Alpha);
    }
    ENDCG
}

// 模板缓冲配合使用
Pass
{
    ColorMask 0  // 不写颜色
    
    Stencil
    {
        Ref 1
        Comp Always
        Pass Replace
    }
}</span>
<span class="p">```</span>

<span class="gu">## Offset（深度偏移）</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">Offset Factor, Units</span>
<span class="p">```</span>

<span class="gs">**作用：**</span>
<span class="p">
-</span> 调整深度值，避免Z-Fighting（深度冲突）
<span class="p">-</span> <span class="sb">`Factor`</span>：基于多边形斜率的偏移
<span class="p">-</span> <span class="sb">`Units`</span>：固定单位偏移

<span class="gs">**应用场景：**</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">// 贴花（Decal）
Pass
{
    Offset -1, -1  // 向相机方向偏移，避免Z-Fighting
    
    CGPROGRAM
    // 渲染贴花
    ENDCG
}

// 描边效果
Pass
{
    Cull Front
    Offset 1, 1  // 向后偏移
    
    CGPROGRAM
    // 渲染背面作为描边
    ENDCG
}</span>
<span class="p">```</span>

<span class="gu">##  Stencil（模板缓冲）</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">Stencil
{
    Ref [_RefValue]         // 参考值（0-255）
    ReadMask [_ReadMask]    // 读取遮罩（默认255）
    WriteMask [_WriteMask]  // 写入遮罩（默认255）
    
    Comp [comparison]       // 比较函数
    Pass [stencilOp]        // 测试通过时的操作
    Fail [stencilOp]        // 测试失败时的操作
    ZFail [stencilOp]       // 深度测试失败时的操作
}</span>
<span class="p">```</span>

<span class="gs">**比较函数（Comp）：**</span>
<span class="p">
-</span> <span class="sb">`Never`</span> - 永不通过
<span class="p">-</span> <span class="sb">`Less`</span> - 小于
<span class="p">-</span> <span class="sb">`Equal`</span> - 等于
<span class="p">-</span> <span class="sb">`LEqual`</span> - 小于等于
<span class="p">-</span> <span class="sb">`Greater`</span> - 大于
<span class="p">-</span> <span class="sb">`NotEqual`</span> - 不等于
<span class="p">-</span> <span class="sb">`GEqual`</span> - 大于等于
<span class="p">-</span> <span class="sb">`Always`</span> - 总是通过

<span class="gs">**操作（Pass/Fail/ZFail）：**</span>
<span class="p">
-</span> <span class="sb">`Keep`</span> - 保持不变
<span class="p">-</span> <span class="sb">`Zero`</span> - 设为0
<span class="p">-</span> <span class="sb">`Replace`</span> - 替换为Ref值
<span class="p">-</span> <span class="sb">`IncrSat`</span> - 加1（饱和，最大255）
<span class="p">-</span> <span class="sb">`DecrSat`</span> - 减1（饱和，最小0）
<span class="p">-</span> <span class="sb">`Invert`</span> - 按位取反
<span class="p">-</span> <span class="sb">`IncrWrap`</span> - 加1（循环）
<span class="p">-</span> <span class="sb">`DecrWrap`</span> - 减1（循环）

<span class="gs">**实际应用：遮罩效果**</span>

<span class="p">```</span><span class="nl">C
</span><span class="sb">// 示例1：遮罩与被遮罩物体

// 遮罩物体（写入模板值）
Shader "Custom/StencilMask"
{
    SubShader
    {
        Tags { "Queue"="Geometry-1" }  // 先渲染
        
        Pass
        {
            ZWrite Off
            ColorMask 0  // 不写颜色
            
            Stencil
            {
                Ref 1
                Comp Always
                Pass Replace  // 写入模板值1
            }
            
            CGPROGRAM
            #pragma vertex vert
            #pragma fragment frag
            
            float4 frag() : SV_Target
            {
                return 0;
            }
            ENDCG
        }
    }
}

// 被遮罩物体（只在遮罩内显示）
Shader "Custom/StencilObject"
{
    SubShader
    {
        Tags { "Queue"="Geometry" }
        
        Pass
        {
            Stencil
            {
                Ref 1
                Comp Equal  // 只在模板值等于1的地方渲染
            }
            
            CGPROGRAM
            #pragma vertex vert
            #pragma fragment frag
            
            fixed4 frag() : SV_Target
            {
                return fixed4(1, 0, 0, 1);
            }
            ENDCG
        }
    }
}</span>
<span class="p">```</span>

<span class="gs">**示例2：描边效果**</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">SubShader
{
    // Pass 1: 写入模板
    Pass
    {
        Stencil
        {
            Ref 1
            Comp Always
            Pass Replace
        }
        
        CGPROGRAM
        // 正常渲染物体
        ENDCG
    }
    
    // Pass 2: 描边（只在物体外部）
    Pass
    {
        Cull Front
        
        Stencil
        {
            Ref 1
            Comp NotEqual  // 不等于1的地方（物体外部）
        }
        
        CGPROGRAM
        // 放大并渲染描边
        v.vertex.xyz += v.normal * _OutlineWidth;
        ENDCG
    }
}</span>
<span class="p">```</span>

<span class="gs">**示例3：传送门效果**</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">// 传送门遮罩
Shader "Custom/PortalMask"
{
    SubShader
    {
        Pass
        {
            ZWrite Off
            ColorMask 0
            
            Stencil
            {
                Ref 1
                Comp Always
                Pass Replace
            }
        }
    }
}

// 传送门另一侧的场景
Shader "Custom/PortalView"
{
    SubShader
    {
        Pass
        {
            Stencil
            {
                Ref 1
                Comp Equal
            }
            
            CGPROGRAM
            // 渲染另一个场景
            ENDCG
        }
    }
}</span>
<span class="p">```</span>

<span class="gu">## AlphaToMask（Alpha转遮罩）</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">AlphaToMask On   // 开启（MSAA时有效）
AlphaToMask Off  // 关闭（默认）</span>
<span class="p">```</span>

<span class="gs">**作用：**</span>
<span class="p">
-</span> 将Alpha值转换为覆盖遮罩
<span class="p">-</span> 用于抗锯齿（需要开启MSAA）
<span class="p">-</span> 适合植被等Alpha Test物体

<span class="gs">**应用场景：**</span>

<span class="p">```</span><span class="nl">C
</span><span class="sb">// 树叶Shader（更好的边缘）
Pass
{
    AlphaToMask On
    
    CGPROGRAM
    fixed4 frag() : SV_Target
    {
        fixed4 col = tex2D(_MainTex, i.uv);
        clip(col.a - _Cutoff);
        return col;
    }
    ENDCG
}</span>
<span class="p">```</span>

<span class="gu">##  Conservative（保守光栅化）</span>
<span class="p">```</span><span class="nl">C
</span><span class="sb">Conservative True   // 开启保守光栅化
Conservative False  // 关闭（默认）</span>
<span class="p">```</span>

<span class="gs">**作用：**</span>
<span class="p">
-</span> 高级功能，确保三角形完全覆盖的像素都被渲染
<span class="p">-</span> 需要硬件支持
<span class="gu">## 常见组合总结</span>

| 效果类型  | Cull  | ZTest   | ZWrite | Blend                     |
| ----- | ----- | ------- | ------ | ------------------------- |
| 不透明物体 | Back  | LEqual  | On     | Off                       |
| 标准透明  | Back  | LEqual  | Off    | SrcAlpha OneMinusSrcAlpha |
| 加法粒子  | Off   | LEqual  | Off    | One One                   |
| 描边    | Front | LEqual  | On     | Off                       |
| UI    | Off   | Always  | Off    | SrcAlpha OneMinusSrcAlpha |
| 天空盒   | Front | LEqual  | Off    | Off                       |
| X光透视  | Back  | Greater | Off    | SrcAlpha OneMinusSrcAlpha |
<span class="gu">## target </span>
<span class="ges">***Shader Model版本，可以省略。Unity会使用默认值：target 2.5***</span>
<span class="gu">### 语法：</span>
<span class="p">```</span><span class="nl">c
</span><span class="cp">#pragma target 2.0  // 指定最低Shader Model版本
#pragma target 2.5
#pragma target 3.0
#pragma target 3.5
#pragma target 4.0
#pragma target 4.5
#pragma target 5.0
#pragma target 6.0</span>
<span class="p">```</span>
<span class="gu">### Unity的Shader Model版本对照</span>

| Unity Target        | Shader Model | 对应年代 | 平台支持              | 关键功能                |
| ------------------- | ------------ | ---- | ----------------- | ------------------- |
| <span class="gs">**2.0**</span>             | SM 2.0       | 2004 | 所有平台              | 基础着色器               |
| <span class="gs">**2.5**</span>             | SM 2.0扩展     | 2005 | PC, Console       | 更多指令                |
| <span class="gs">**3.0**</span>             | SM 3.0       | 2006 | PC, Console, 高端移动 | MRT, 更多插值器          |
| <span class="gs">**3.5**</span> (GL ES 3.0) | SM 3.0+      | 2012 | 现代移动              | MRT, Compute Shader |
| <span class="gs">**4.0**</span>             | SM 4.0       | 2008 | DX10+             | 几何着色器               |
| <span class="gs">**4.5**</span>             | SM 4.5       | 2009 | DX11+             | 曲面细分                |
| <span class="gs">**5.0**</span>             | SM 5.0       | 2011 | DX11+             | 完整Compute Shader    |
| <span class="gs">**6.0**</span>             | SM 6.0       | 2018 | DX12, Vulkan      | 光线追踪、Mesh Shader    |
<span class="gh"># 顶点/片元着色器</span>
<span class="gu">## 结构体</span>
<span class="p">```</span><span class="nl">c
</span><span class="k">struct</span> <span class="n">appdata</span>
<span class="p">{</span>
    <span class="n">float4</span> <span class="n">vertex</span> <span class="o">:</span> <span class="n">POSITION</span><span class="p">;</span>   <span class="c1">// 顶点位置</span>
    <span class="n">float3</span> <span class="n">normal</span> <span class="o">:</span> <span class="n">NORMAL</span><span class="p">;</span>     <span class="c1">// 法线</span>
    <span class="n">float4</span> <span class="n">tangent</span> <span class="o">:</span> <span class="n">TANGENT</span><span class="p">;</span>   <span class="c1">// 切线</span>
    <span class="n">float2</span> <span class="n">uv</span> <span class="o">:</span> <span class="n">TEXCOORD0</span><span class="p">;</span>      <span class="c1">// UV0</span>
    <span class="n">float2</span> <span class="n">uv1</span> <span class="o">:</span> <span class="n">TEXCOORD1</span><span class="p">;</span>     <span class="c1">// UV1（光照贴图）</span>
    <span class="n">float4</span> <span class="n">color</span> <span class="o">:</span> <span class="n">COLOR</span><span class="p">;</span>       <span class="c1">// 顶点颜色</span>
<span class="p">};</span>
<span class="p">```</span>
<span class="gs">**完整的顶点输入语义列表：**</span>

| 语义              | 含义                   | 数据类型          |
| --------------- | -------------------- | ------------- |
| <span class="sb">`POSITION`</span>      | 顶点位置（模型空间）           | float4        |
| <span class="sb">`NORMAL`</span>        | 法线（模型空间）             | float3        |
| <span class="sb">`TANGENT`</span>       | 切线（模型空间）             | float4        |
| <span class="sb">`TEXCOORD0`</span>     | 第一套UV                | float2/float4 |
| <span class="sb">`TEXCOORD1`</span>     | 第二套UV（光照贴图）          | float2/float4 |
| <span class="sb">`TEXCOORD2`</span>     | 第三套UV                | float2/float4 |
| <span class="sb">`TEXCOORD3`</span>     | 第四套UV                | float2/float4 |
| <span class="sb">`COLOR`</span>         | 顶点颜色                 | float4        |
| <span class="sb">`SV_VertexID`</span>   | 顶点ID                 | uint          |
| <span class="sb">`SV_InstanceID`</span> | 实例ID（GPU Instancing） | uint          |

<span class="gu">## TEXCOORD的数量限制 </span>
<span class="gu">### 不同Shader Model的支持</span>
Shader Model 2.0：
<span class="p">-</span> 最多8个TEXCOORD（0-7）
<span class="p">-</span> 每个最多float4
<span class="p">-</span> 总共32个float Shader Model
<span class="p">-</span> 3.0：
<span class="p">-</span> 最多10个TEXCOORD（0-9） 
<span class="p">-</span> 每个最多float4 
<span class="p">-</span> 总共40个float Shader Model 
<span class="p">-</span> 4.0+：
<span class="p">-</span> 最多16个插值器 - 使用不同的命名（但TEXCOORD仍然有效） 
Unity默认：
<span class="gh">#pragma target 2.5 </span>
<span class="p">-</span> 支持10个TEXCOORD（0-9） 
如果需要更多：
<span class="gh">#pragma target 3.0 或更高</span>
<span class="gu">### **完整支持表**</span>

|Shader Model|TEXCOORD数量|每个类型|总float数|Unity target|
|---|---|---|---|---|
|SM 2.0|8 (0-7)|float4|32|target 2.0|
|SM 2.5|10 (0-9)|float4|40|target 2.5（默认）|
|SM 3.0|10 (0-9)|float4|40|target 3.0|
|SM 4.0+|16|float4|64|target 4.0+|
<span class="gh"># 片元输出语义</span>

<span class="p">```</span><span class="nl">c
</span><span class="n">fixed4</span> <span class="nf">frag</span><span class="p">(</span><span class="n">v2f</span> <span class="n">i</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_Target</span>  <span class="c1">// ← 输出到渲染目标</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">fixed4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">// 输出红色</span>
<span class="err">}</span>
<span class="p">```</span>
<span class="gs">**常用输出语义：**</span>
<span class="ges">***这里语义主要是声明在Struct中的，片元后面默认就SV_Target或者说是SV_Target0，如果多输出的话就可以不写***</span>

|语义|含义|用途|
|---|---|---|
|<span class="sb">`SV_Target`</span>|渲染目标0|输出颜色到屏幕|
|<span class="sb">`SV_Target0`</span>|渲染目标0|同上（明确写0）|
|<span class="sb">`SV_Target1`</span>|渲染目标1|多渲染目标（MRT）|
|<span class="sb">`SV_Target2`</span>|渲染目标2|MRT|
|<span class="sb">`SV_Target3`</span>|渲染目标3|MRT|
|<span class="sb">`SV_Depth`</span>|深度值|自定义深度|
|<span class="sb">`COLOR`</span>|颜色（旧版）|被SV_Target取代|

<span class="gh"># 延迟管线</span>
<span class="ges">***多输出是使用延迟管线，先输出各个图，然后一起计算光照***</span>
<span class="p">```</span><span class="nl">c
</span><span class="c1">// 必须用结构体 + MRT（但还是一个Pass！）</span>
<span class="k">struct</span> <span class="n">GBufferOutput</span>
<span class="p">{</span>
    <span class="n">fixed4</span> <span class="n">albedo</span> <span class="o">:</span> <span class="n">SV_Target0</span><span class="p">;</span>
    <span class="n">fixed4</span> <span class="n">specular</span> <span class="o">:</span> <span class="n">SV_Target1</span><span class="p">;</span>
    <span class="n">fixed4</span> <span class="n">normal</span> <span class="o">:</span> <span class="n">SV_Target2</span><span class="p">;</span>
    <span class="n">fixed4</span> <span class="n">emission</span> <span class="o">:</span> <span class="n">SV_Target3</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">GBufferOutput</span> <span class="nf">frag</span><span class="p">(</span><span class="n">v2f</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">GBufferOutput</span> <span class="n">o</span><span class="p">;</span>
    <span class="n">o</span><span class="p">.</span><span class="n">albedo</span> <span class="o">=</span> <span class="n">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
    <span class="n">o</span><span class="p">.</span><span class="n">specular</span> <span class="o">=</span> <span class="n">tex2D</span><span class="p">(</span><span class="n">_SpecMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
    <span class="n">o</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">UnpackNormal</span><span class="p">(</span><span class="n">tex2D</span><span class="p">(</span><span class="n">_BumpMap</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">));</span>
    <span class="n">o</span><span class="p">.</span><span class="n">emission</span> <span class="o">=</span> <span class="n">_Emission</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">o</span><span class="p">;</span>  <span class="c1">// 同时输出4个值，只调用一次！</span>
<span class="p">}</span>
<span class="p">```</span>

<span class="gu">### 实现方法参考</span>
<span class="p">```</span><span class="nl">c
</span><span class="n">SubShader</span>
<span class="p">{</span>
    <span class="n">Pass</span>
    <span class="p">{</span>
        <span class="n">CGPROGRAM</span>
        <span class="cp">#pragma vertex vert
</span>        <span class="cp">#pragma fragment frag
</span>        <span class="cp">#pragma target 3.0  // MRT需要SM3.0+
</span>        
        <span class="n">sampler2D</span> <span class="n">_MainTex</span><span class="p">;</span>
        
        <span class="k">struct</span> <span class="n">v2f</span>
        <span class="p">{</span>
            <span class="n">float4</span> <span class="n">pos</span> <span class="o">:</span> <span class="n">SV_POSITION</span><span class="p">;</span>
            <span class="n">float2</span> <span class="n">uv</span> <span class="o">:</span> <span class="n">TEXCOORD0</span><span class="p">;</span>
            <span class="n">float3</span> <span class="n">normal</span> <span class="o">:</span> <span class="n">TEXCOORD1</span><span class="p">;</span>
            <span class="kt">float</span> <span class="n">depth</span> <span class="o">:</span> <span class="n">TEXCOORD2</span><span class="p">;</span>
        <span class="p">};</span>
        
        <span class="n">v2f</span> <span class="n">vert</span><span class="p">(</span><span class="n">appdata_base</span> <span class="n">v</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">v2f</span> <span class="n">o</span><span class="p">;</span>
            <span class="n">o</span><span class="p">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">UnityObjectToClipPos</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">vertex</span><span class="p">);</span>
            <span class="n">o</span><span class="p">.</span><span class="n">uv</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">texcoord</span><span class="p">;</span>
            <span class="n">o</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">UnityObjectToWorldNormal</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">normal</span><span class="p">);</span>
            <span class="n">o</span><span class="p">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">pos</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">o</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1">// 定义多输出结构体</span>
        <span class="k">struct</span> <span class="n">FragOutput</span>
        <span class="p">{</span>
            <span class="n">fixed4</span> <span class="n">albedo</span> <span class="o">:</span> <span class="n">SV_Target0</span><span class="p">;</span>  <span class="c1">// 输出到RT0</span>
            <span class="n">fixed4</span> <span class="n">normal</span> <span class="o">:</span> <span class="n">SV_Target1</span><span class="p">;</span>  <span class="c1">// 输出到RT1</span>
            <span class="n">fixed4</span> <span class="n">depth</span> <span class="o">:</span> <span class="n">SV_Target2</span><span class="p">;</span>   <span class="c1">// 输出到RT2</span>
        <span class="p">};</span>
        
        <span class="c1">// 一次frag调用，同时输出3个值</span>
        <span class="n">FragOutput</span> <span class="n">frag</span><span class="p">(</span><span class="n">v2f</span> <span class="n">i</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">FragOutput</span> <span class="n">o</span><span class="p">;</span>
            
            <span class="c1">// 同时计算所有数据</span>
            <span class="n">o</span><span class="p">.</span><span class="n">albedo</span> <span class="o">=</span> <span class="n">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
            <span class="n">o</span><span class="p">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">fixed4</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">normal</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="n">o</span><span class="p">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">fixed4</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">depth</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">depth</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            
            <span class="c1">// 一次return，同时输出到3个RT</span>
            <span class="k">return</span> <span class="n">o</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ENDCG</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 优点：</span>
<span class="c1">// - 只执行一次顶点着色器</span>
<span class="c1">// - 只执行一次frag函数</span>
<span class="c1">// - GPU硬件支持，非常高效</span>
<span class="c1">// - 这就是延迟渲染的基础</span>
<span class="p">```</span>
<span class="p">
---
</span>
<span class="gu">## C#端如何接收多渲染目标</span>

<span class="p">```</span><span class="nl">csharp
</span><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">MRTExample</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">Shader</span> <span class="n">mrtShader</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Material</span> <span class="n">mrtMaterial</span><span class="p">;</span>
    
    <span class="k">private</span> <span class="n">RenderTexture</span> <span class="n">rt0</span><span class="p">;</span>  <span class="c1">// Albedo</span>
    <span class="k">private</span> <span class="n">RenderTexture</span> <span class="n">rt1</span><span class="p">;</span>  <span class="c1">// Normal</span>
    <span class="k">private</span> <span class="n">RenderTexture</span> <span class="n">rt2</span><span class="p">;</span>  <span class="c1">// Depth</span>
    
    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// 创建3个RenderTexture</span>
        <span class="n">rt0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RenderTexture</span><span class="p">(</span><span class="m">512</span><span class="p">,</span> <span class="m">512</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        <span class="n">rt1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RenderTexture</span><span class="p">(</span><span class="m">512</span><span class="p">,</span> <span class="m">512</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        <span class="n">rt2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RenderTexture</span><span class="p">(</span><span class="m">512</span><span class="p">,</span> <span class="m">512</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
        
        <span class="n">mrtMaterial</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Material</span><span class="p">(</span><span class="n">mrtShader</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">void</span> <span class="nf">OnRenderImage</span><span class="p">(</span><span class="n">RenderTexture</span> <span class="n">source</span><span class="p">,</span> <span class="n">RenderTexture</span> <span class="n">destination</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 设置多渲染目标（MRT）</span>
        <span class="n">RenderBuffer</span><span class="p">[]</span> <span class="n">colorBuffers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RenderBuffer</span><span class="p">[</span><span class="m">3</span><span class="p">];</span>
        <span class="n">colorBuffers</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="n">rt0</span><span class="p">.</span><span class="n">colorBuffer</span><span class="p">;</span>  <span class="c1">// SV_Target0</span>
        <span class="n">colorBuffers</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="n">rt1</span><span class="p">.</span><span class="n">colorBuffer</span><span class="p">;</span>  <span class="c1">// SV_Target1</span>
        <span class="n">colorBuffers</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">=</span> <span class="n">rt2</span><span class="p">.</span><span class="n">colorBuffer</span><span class="p">;</span>  <span class="c1">// SV_Target2</span>
        
        <span class="c1">// 一次Graphics.Blit，同时输出到3个RT</span>
        <span class="n">Graphics</span><span class="p">.</span><span class="nf">SetRenderTarget</span><span class="p">(</span><span class="n">colorBuffers</span><span class="p">,</span> <span class="n">rt0</span><span class="p">.</span><span class="n">depthBuffer</span><span class="p">);</span>
        <span class="n">Graphics</span><span class="p">.</span><span class="nf">Blit</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mrtMaterial</span><span class="p">);</span>
        
        <span class="c1">// 现在rt0、rt1、rt2都已经填充了数据</span>
        <span class="c1">// 只调用了一次frag函数！</span>
        
        <span class="c1">// 显示结果</span>
        <span class="n">Graphics</span><span class="p">.</span><span class="nf">Blit</span><span class="p">(</span><span class="n">rt0</span><span class="p">,</span> <span class="n">destination</span><span class="p">);</span>  <span class="c1">// 显示Albedo</span>
    <span class="p">}</span>
    
    <span class="c1">// 调试：显示3个RT</span>
    <span class="k">void</span> <span class="nf">OnGUI</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">GUI</span><span class="p">.</span><span class="nf">DrawTexture</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">256</span><span class="p">,</span> <span class="m">256</span><span class="p">),</span> <span class="n">rt0</span><span class="p">);</span>
        <span class="n">GUI</span><span class="p">.</span><span class="nf">DrawTexture</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">256</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">256</span><span class="p">,</span> <span class="m">256</span><span class="p">),</span> <span class="n">rt1</span><span class="p">);</span>
        <span class="n">GUI</span><span class="p">.</span><span class="nf">DrawTexture</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">512</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">256</span><span class="p">,</span> <span class="m">256</span><span class="p">),</span> <span class="n">rt2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="p">```</span>

<span class="gh"># 数据类型快速参考表</span>

<span class="gu">### **一、精度类型对比**</span>

| 精度类型      | 位数  | 范围        | 精度      | 桌面性能    | 移动性能 | 跨平台一致性 | <span class="gs">**推荐度**</span>   |
| --------- | --- | --------- | ------- | ------- | ---- | ------ | --------- |
| <span class="gs">**half**</span>  | 16位 | ±60000    | ~0.001  | 等于float | ⭐⭐⭐  | ⭐⭐⭐⭐   | ✅ <span class="gs">**主力**</span>  |
| <span class="gs">**float**</span> | 32位 | ±3.4×10³⁸ | ~7位有效数字 | float   | ⭐    | ⭐⭐⭐⭐⭐  | ✅ <span class="gs">**必要时**</span> |
| <span class="gs">**fixed**</span> | 11位 | [-2, 2]   | ~0.004  | 等于float | ⭐⭐⭐  | ⭐⭐     | ❌ <span class="gs">**避免**</span>  |
<span class="p">
---
</span>
<span class="gu">### **二、常用数据类型精度选择**</span>

|数据类型|推荐精度|原因|示例|
|---|---|---|---|
|<span class="gs">**🎨 颜色（RGB/RGBA）**</span>|<span class="sb">`half4`</span>|精度足够，跨平台一致|<span class="sb">`half4 color`</span>|
|<span class="gs">**📐 法线**</span>|<span class="sb">`half3`</span>|归一化向量，精度足够|<span class="sb">`half3 normal`</span>|
|<span class="gs">**📐 切线/副切线**</span>|<span class="sb">`half3`</span>|同法线|<span class="sb">`half3 tangent`</span>|
|<span class="gs">**🗺️ UV坐标**</span>|<span class="sb">`half2`</span>|通常小范围|<span class="sb">`half2 uv`</span>|
|<span class="gs">**💡 光照方向**</span>|<span class="sb">`half3`</span>|归一化向量|<span class="sb">`half3 lightDir`</span>|
|<span class="gs">**👁️ 视线方向**</span>|<span class="sb">`half3`</span>|归一化向量|<span class="sb">`half3 viewDir`</span>|
|<span class="gs">**✖️ 点积结果（NdotL等）**</span>|<span class="sb">`half`</span>|[-1,1]范围|<span class="sb">`half ndotl`</span>|
|<span class="gs">**🎚️ PBR系数（金属度/粗糙度）**</span>|<span class="sb">`half`</span>|[0,1]范围|<span class="sb">`half metallic`</span>|
|<span class="gs">**🎭 遮罩/Alpha**</span>|<span class="sb">`half`</span>|[0,1]范围|<span class="sb">`half mask`</span>|
|<span class="gs">**📦 纹理采样结果**</span>|<span class="sb">`half4`</span>|直接返回half|<span class="sb">`half4 tex2D(...)`</span>|
|<span class="gs">**🌍 世界空间坐标**</span>|<span class="sb">`float3`</span>|可能很大（几千米）|<span class="sb">`float3 worldPos`</span>|
|<span class="gs">**📍 裁剪空间位置**</span>|<span class="sb">`float4`</span>|<span class="gs">**必须**</span>（SV_POSITION）|<span class="sb">`float4 pos`</span>|
|<span class="gs">**🔢 矩阵**</span>|<span class="sb">`float4x4`</span>|精度要求高|<span class="sb">`float4x4 matrix`</span>|
|<span class="gs">**⏱️ 时间/累加计算**</span>|<span class="sb">`float`</span>|避免精度损失|<span class="sb">`float time`</span>|
|<span class="gs">**📏 大范围距离**</span>|<span class="sb">`float`</span>|可能很大|<span class="sb">`float distance`</span>|
|<span class="gs">**📐 复杂数学函数**</span>|<span class="sb">`float`</span>|sin/cos/exp等|<span class="sb">`float sine`</span>|

</code></pre></div></div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 吟处雪 轻遮. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="external nofollow noopener">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>